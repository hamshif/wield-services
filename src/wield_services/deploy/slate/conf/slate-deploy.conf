deploy = {
  apiVersion: extensions/v1beta1
  kind: Deployment
  metadata = {
    name = slate
    labels = {
      app: slate
    }
  }
  spec = {
    replicas = ${slate.replicas}
    selector = {
      matchLabels = {
        app = slate
      }
    }

    strategy = {
      type = Recreate
    }
    template = {
      metadata = {
        labels = {
          app = slate
        }
      }

      spec = {
        volumes = [
          {
            name: slate-storage
            persistentVolumeClaim = {
              claimName: slate-pvc
            }
          }
        ]

        containers = [
          {
            name = slate
            image = ${slate.image}
            ports = [
              {
                name = slate-debug
                containerPort = ${slate.containerPort}
              }
            ]
            volumeMounts = [
              {
                name = slate-storage
                mountPath = /code_path
              }
            ]
          }
        ]
      }
    }
  }
}
